/*! For license information please see 364.js.LICENSE.txt */
"use strict";(self.webpackChunkinqviz_excel=self.webpackChunkinqviz_excel||[]).push([[364],{46993:function(e,t,r){r.d(t,{m:function(){return a}});var n=r(77003);class a extends n.YN{get lc_attributes(){return{partialVariables:void 0}}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{inputVariables:t}=e;if(t.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,e)}async mergePartialAndUserVariables(e){const t=this.partialVariables??{},r={};for(const[e,n]of Object.entries(t))r[e]="string"==typeof n?n:await n();return{...r,...e}}async invoke(e,t){return this._callWithConfig((e=>this.formatPromptValue(e)),e,{...t,runType:"prompt"})}serialize(){throw new Error("Use .toJSON() instead")}static async deserialize(e){switch(e._type){case"prompt":{const{PromptTemplate:t}=await Promise.resolve().then(r.bind(r,23650));return t.deserialize(e)}case void 0:{const{PromptTemplate:t}=await Promise.resolve().then(r.bind(r,23650));return t.deserialize({...e,_type:"prompt"})}case"few_shot":{const{FewShotPromptTemplate:t}=await r.e(771).then(r.bind(r,62771));return t.deserialize(e)}default:throw new Error(`Invalid prompt type in config: ${e._type}`)}}}},23650:function(e,t,r){r.d(t,{PromptTemplate:function(){return i}});var n=r(90329),a=r(69849);class i extends n.L{static lc_name(){return"PromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),"mustache"===e.templateFormat&&void 0===e.validateTemplate&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){if("mustache"===this.templateFormat)throw new Error("Mustache templates cannot be validated.");let e=this.inputVariables;this.partialVariables&&(e=e.concat(Object.keys(this.partialVariables))),(0,a.Ns)(this.template,this.templateFormat,e)}}_getPromptType(){return"prompt"}async format(e){const t=await this.mergePartialAndUserVariables(e);return(0,a.Xm)(this.template,this.templateFormat,t)}static fromExamples(e,t,r,n="\n\n",a=""){const s=[a,...e,t].join(n);return new i({inputVariables:r,template:s})}static fromTemplate(e,t){const{templateFormat:r="f-string",...n}=t??{},s=new Set;return(0,a.QC)(e,r).forEach((e=>{"variable"===e.type&&s.add(e.name)})),new i({inputVariables:[...s],templateFormat:r,template:e,...n})}async partial(e){const t=this.inputVariables.filter((t=>!(t in e))),r={...this.partialVariables??{},...e},n={...this,inputVariables:t,partialVariables:r};return new i(n)}serialize(){if(void 0!==this.outputParser)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw new Error("Prompt template must have a template");return new i({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}}},90329:function(e,t,r){r.d(t,{L:function(){return i}});var n=r(95311),a=r(46993);class i extends a.m{async formatPromptValue(e){const t=await this.format(e);return new n.HY(t)}}},69849:function(e,t,r){r.d(t,{Ns:function(){return T},D4:function(){return x},QC:function(){return j},Xm:function(){return C}});var n=Object.prototype.toString,a=Array.isArray||function(e){return"[object Array]"===n.call(e)};function i(e){return"function"==typeof e}function s(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function o(e,t){return null!=e&&"object"==typeof e&&t in e}var l=RegExp.prototype.test,p=/\S/;var c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},u=/\s*/,h=/\s+/,f=/\s*=/,m=/\s*\}/,d=/#|\^|\/|>|\{|&|=|!/;function g(e){this.string=e,this.tail=e,this.pos=0}function v(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function b(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}g.prototype.eos=function(){return""===this.tail},g.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var r=t[0];return this.tail=this.tail.substring(r.length),this.pos+=r.length,r},g.prototype.scanUntil=function(e){var t,r=this.tail.search(e);switch(r){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=t.length,t},v.prototype.push=function(e){return new v(e,this)},v.prototype.lookup=function(e){var t,r,n,a=this.cache;if(a.hasOwnProperty(e))t=a[e];else{for(var s,l,p,c=this,u=!1;c;){if(e.indexOf(".")>0)for(s=c.view,l=e.split("."),p=0;null!=s&&p<l.length;)p===l.length-1&&(u=o(s,l[p])||(r=s,n=l[p],null!=r&&"object"!=typeof r&&r.hasOwnProperty&&r.hasOwnProperty(n))),s=s[l[p++]];else s=c.view[e],u=o(c.view,e);if(u){t=s;break}c=c.parent}a[e]=t}return i(t)&&(t=t.call(this.view)),t},b.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},b.prototype.parse=function(e,t){var r=this.templateCache,n=e+":"+(t||w.tags).join(":"),i=void 0!==r,o=i?r.get(n):void 0;return null==o&&(o=function(e,t){if(!e)return[];var r,n,i,o,c=!1,v=[],b=[],y=[],P=!1,x=!1,E="",_=0;function C(){if(P&&!x)for(;y.length;)delete b[y.pop()];else y=[];P=!1,x=!1}function j(e){if("string"==typeof e&&(e=e.split(h,2)),!a(e)||2!==e.length)throw new Error("Invalid tags: "+e);r=new RegExp(s(e[0])+"\\s*"),n=new RegExp("\\s*"+s(e[1])),i=new RegExp("\\s*"+s("}"+e[1]))}j(t||w.tags);for(var T,V,k,O,U,S,z=new g(e);!z.eos();){if(T=z.pos,k=z.scanUntil(r))for(var F=0,A=k.length;F<A;++F)o=O=k.charAt(F),function(e,t){return l.call(e,t)}(p,o)?(x=!0,c=!0,E+=" "):(y.push(b.length),E+=O),b.push(["text",O,T,T+1]),T+=1,"\n"===O&&(C(),E="",_=0,c=!1);if(!z.scan(r))break;if(P=!0,V=z.scan(d)||"name",z.scan(u),"="===V?(k=z.scanUntil(f),z.scan(f),z.scanUntil(n)):"{"===V?(k=z.scanUntil(i),z.scan(m),z.scanUntil(n),V="&"):k=z.scanUntil(n),!z.scan(n))throw new Error("Unclosed tag at "+z.pos);if(U=">"==V?[V,k,T,z.pos,E,_,c]:[V,k,T,z.pos],_++,b.push(U),"#"===V||"^"===V)v.push(U);else if("/"===V){if(!(S=v.pop()))throw new Error('Unopened section "'+k+'" at '+T);if(S[1]!==k)throw new Error('Unclosed section "'+S[1]+'" at '+T)}else"name"===V||"{"===V||"&"===V?x=!0:"="===V&&j(k)}if(C(),S=v.pop())throw new Error('Unclosed section "'+S[1]+'" at '+z.pos);return function(e){for(var t,r=[],n=r,a=[],i=0,s=e.length;i<s;++i)switch((t=e[i])[0]){case"#":case"^":n.push(t),a.push(t),n=t[4]=[];break;case"/":a.pop()[5]=t[2],n=a.length>0?a[a.length-1][4]:r;break;default:n.push(t)}return r}(function(e){for(var t,r,n=[],a=0,i=e.length;a<i;++a)(t=e[a])&&("text"===t[0]&&r&&"text"===r[0]?(r[1]+=t[1],r[3]=t[3]):(n.push(t),r=t));return n}(b))}(e,t),i&&r.set(n,o)),o},b.prototype.render=function(e,t,r,n){var a=this.getConfigTags(n),i=this.parse(e,a),s=t instanceof v?t:new v(t,void 0);return this.renderTokens(i,s,r,e,n)},b.prototype.renderTokens=function(e,t,r,n,a){for(var i,s,o,l="",p=0,c=e.length;p<c;++p)o=void 0,"#"===(s=(i=e[p])[0])?o=this.renderSection(i,t,r,n,a):"^"===s?o=this.renderInverted(i,t,r,n,a):">"===s?o=this.renderPartial(i,t,r,a):"&"===s?o=this.unescapedValue(i,t):"name"===s?o=this.escapedValue(i,t,a):"text"===s&&(o=this.rawValue(i)),void 0!==o&&(l+=o);return l},b.prototype.renderSection=function(e,t,r,n,s){var o=this,l="",p=t.lookup(e[1]);if(p){if(a(p))for(var c=0,u=p.length;c<u;++c)l+=this.renderTokens(e[4],t.push(p[c]),r,n,s);else if("object"==typeof p||"string"==typeof p||"number"==typeof p)l+=this.renderTokens(e[4],t.push(p),r,n,s);else if(i(p)){if("string"!=typeof n)throw new Error("Cannot use higher-order sections without the original template");null!=(p=p.call(t.view,n.slice(e[3],e[5]),(function(e){return o.render(e,t,r,s)})))&&(l+=p)}else l+=this.renderTokens(e[4],t,r,n,s);return l}},b.prototype.renderInverted=function(e,t,r,n,i){var s=t.lookup(e[1]);if(!s||a(s)&&0===s.length)return this.renderTokens(e[4],t,r,n,i)},b.prototype.indentPartial=function(e,t,r){for(var n=t.replace(/[^ \t]/g,""),a=e.split("\n"),i=0;i<a.length;i++)a[i].length&&(i>0||!r)&&(a[i]=n+a[i]);return a.join("\n")},b.prototype.renderPartial=function(e,t,r,n){if(r){var a=this.getConfigTags(n),s=i(r)?r(e[1]):r[e[1]];if(null!=s){var o=e[6],l=e[5],p=e[4],c=s;0==l&&p&&(c=this.indentPartial(s,p,o));var u=this.parse(c,a);return this.renderTokens(u,t,r,c,n)}}},b.prototype.unescapedValue=function(e,t){var r=t.lookup(e[1]);if(null!=r)return r},b.prototype.escapedValue=function(e,t,r){var n=this.getConfigEscape(r)||w.escape,a=t.lookup(e[1]);if(null!=a)return"number"==typeof a&&n===w.escape?String(a):n(a)},b.prototype.rawValue=function(e){return e[1]},b.prototype.getConfigTags=function(e){return a(e)?e:e&&"object"==typeof e?e.tags:void 0},b.prototype.getConfigEscape=function(e){return e&&"object"==typeof e&&!a(e)?e.escape:void 0};var w={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){y.templateCache=e},get templateCache(){return y.templateCache}},y=new b;w.clearCache=function(){return y.clearCache()},w.parse=function(e,t){return y.parse(e,t)},w.render=function(e,t,r,n){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+(a(i=e)?"array":typeof i)+'" was given as the first argument for mustache#render(template, view, partials)');var i;return y.render(e,t,r,n)},w.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return c[e]}))},w.Scanner=g,w.Context=v,w.Writer=b;var P=w;const x=e=>{const t=e.split(""),r=[],n=(e,r)=>{for(let n=r;n<t.length;n+=1)if(e.includes(t[n]))return n;return-1};let a=0;for(;a<t.length;)if("{"===t[a]&&a+1<t.length&&"{"===t[a+1])r.push({type:"literal",text:"{"}),a+=2;else if("}"===t[a]&&a+1<t.length&&"}"===t[a+1])r.push({type:"literal",text:"}"}),a+=2;else if("{"===t[a]){const e=n("}",a);if(e<0)throw new Error("Unclosed '{' in template.");r.push({type:"variable",name:t.slice(a+1,e).join("")}),a=e+1}else{if("}"===t[a])throw new Error("Single '}' in template.");{const e=n("{}",a),i=(e<0?t.slice(a):t.slice(a,e)).join("");r.push({type:"literal",text:i}),a=e<0?t.length:e}}return r},E={"f-string":(e,t)=>x(e).reduce(((e,r)=>{if("variable"===r.type){if(r.name in t)return e+t[r.name];throw new Error(`(f-string) Missing value for input ${r.name}`)}return e+r.text}),""),mustache:(e,t)=>P.render(e,t)},_={"f-string":x,mustache:e=>(e=>e.map((e=>"name"===e[0]?{type:"variable",name:e[1].includes(".")?e[1].split(".")[0]:e[1]}:"#"===e[0]?{type:"variable",name:e[1]}:{type:"literal",text:e[1]})))(P.parse(e))},C=(e,t,r)=>E[t](e,r),j=(e,t)=>_[t](e),T=(e,t,r)=>{if(!(t in E)){const e=Object.keys(E);throw new Error(`Invalid template format. Got \`${t}\`;\n                         should be one of ${e}`)}try{const n=r.reduce(((e,t)=>(e[t]="foo",e)),{});Array.isArray(e)?e.forEach((e=>{if("text"===e.type)C(e.text,t,n);else{if("image_url"!==e.type)throw new Error(`Invalid message template received. ${JSON.stringify(e,null,2)}`);if("string"==typeof e.image_url)C(e.image_url,t,n);else{const r=e.image_url.url;C(r,t,n)}}})):C(e,t,n)}catch(e){throw new Error(`Invalid prompt schema: ${e.message}`)}}}}]);
//# sourceMappingURL=364.js.map